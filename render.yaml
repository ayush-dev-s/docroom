services:
  - type: web
    name: docroom-api
    env: node
    plan: free
    rootDir: api
    buildCommand: npm ci && npm run build
    startCommand: npm run start
    envVars:
      - key: PORT
        value: 10000
      - key: JWT_SECRET
        generateValue: true
      - key: MONGO_URI
        # set in dashboard to your MongoDB Atlas connection string
        value: ""
      - key: S3_ENDPOINT
        # leave empty to use AWS default; set if using custom endpoint
        value: ""
      - key: S3_REGION
        value: "us-east-1"
      - key: S3_ACCESS_KEY
        value: ""
      - key: S3_SECRET_KEY
        value: ""
      - key: S3_BUCKET
        value: "docroom"
      - key: S3_USE_PATH_STYLE
        value: "false"
      - key: CORS_ORIGIN
        value: "*"
  - type: web
    name: docroom-web
    env: node
    plan: free
    rootDir: web
    buildCommand: npm ci && npm run build
    startCommand: npm run start
    envVars:
      - key: NEXT_PUBLIC_API_URL
        # set to the API service URL after first deploy
        value: ""